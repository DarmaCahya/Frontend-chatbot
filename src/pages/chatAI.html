<!DOCTYPE html>
<html lang="id">

<head>
    <!-- Metadata dan tautan CSS -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chatbot Satria BIPA</title>
    <!-- Menggunakan font Plus Jakarta Sans -->
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;700&display=swap"
        rel="stylesheet">
    <!-- Memuat Tailwind CSS dan Flowbite -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script
        src="https://cdn.jsdelivr.net/npm/flowbite@2.5.2/dist/flowbite.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/flowbite@2.5.2/dist/flowbite.min.css"
        rel="stylesheet" />

    <script>
        tailwind.config = {
            darkMode: "class",
        }
    </script>
    <script>
        // Fungsi untuk menginisialisasi dan toggle dark mode
        function initMode() {
            if (localStorage.theme === 'dark' ||
                (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
        }

        function toggleMode() {
            if (document.documentElement.classList.contains('dark')) {
                document.documentElement.classList.remove('dark');
                localStorage.theme = 'light';
            } else {
                document.documentElement.classList.add('dark');
                localStorage.theme = 'dark';
            }
        }

        // Inisialisasi dark mode saat halaman dimuat
        document.addEventListener('DOMContentLoaded', initMode);
    </script>

    <style>
        body {
            font-family: "Plus Jakarta Sans", sans-serif;
        }

        .icon:hover path {
            fill: black;
        }

        /* Pastikan html dan body mengambil tinggi penuh */
        html,
        body {
            height: 100%;
            margin: 0;
        }

        /* Custom scrollbar styling untuk tampilan minimalis */
        .scrollbar-custom::-webkit-scrollbar {
            width: 6px;
        }

        .scrollbar-custom::-webkit-scrollbar-track {
            background: transparent;
        }

        .scrollbar-custom::-webkit-scrollbar-thumb {
            background-color: rgba(255, 255, 255, 0.3);
            border-radius: 3px;
        }

        .scrollbar-custom::-webkit-scrollbar-thumb:hover {
            background-color: rgba(255, 255, 255, 0.5);
        }

        /* Firefox */
        .scrollbar-custom {
            scrollbar-width: thin;
            scrollbar-color: rgba(255, 255, 255, 0.3) transparent;
        }

        /* Menyesuaikan tinggi kontainer utama */
        .main-container {
            display: flex;
            min-height: 100vh;
        }

        /* Gaya sidebar */
        aside {
            flex-shrink: 0;
            display: flex;
            flex-direction: column;
        }

        /* Gaya konten utama */
        .content {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        header {
            flex-shrink: 0;
        }

        main {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .chat-area {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .chat-box {
            flex: 1;
            overflow-y: auto;
            padding: 1rem;
        }

        .input-area {
            flex-shrink: 0;
            padding: 1rem;
            background-color: #ffffff;
        }

        .input-area.dark {
            background-color: #1B1B21;
        }

        /* Gaya footer */
        footer {
            flex-shrink: 0;
        }

        /* Styling Chat Aktif */
        .active-chat {
            background-color: #444;
            color: white;
        }

        /* Efek Hover untuk Chat Items */
        .chat-item:hover {
            background-color: #555;
            color: white;
        }

        /* Tambahan untuk menghindari teks terpotong */
        .chat-box div {
            word-wrap: break-word;
        }
    </style>
</head>

<body class="bg-white dark:bg-[#1B1B21] text-black dark:text-white transition duration-75">
    <div class="main-container">
        <!-- Sidebar -->
        <aside id="default-sidebar"
            class="fixed bg-black h-screen top-0 left-0 z-40 w-80 md:w-[22rem] lg:w-[25rem] overflow-y-auto scrollbar-custom flex flex-col transition-transform -translate-x-full md:translate-x-0 text-gray-400">
            <!-- Tombol untuk menutup sidebar pada layar kecil -->
            <div class="flex justify-end p-4 md:hidden">
                <button data-drawer-hide="default-sidebar" aria-controls="default-sidebar" type="button"
                    class="text-gray-400 hover:text-white">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" clip-rule="evenodd"
                            d="M4.293 4.293a1 1 0 011.414 0L10 
                            8.586l4.293-4.293a1 1 0 111.414 
                            1.414L11.414 10l4.293 4.293a1 1 0 
                            01-1.414 1.414L10 11.414l-4.293 
                            4.293a1 1 0 01-1.414-1.414L8.586 
                            10 4.293 5.707a1 1 0 010-1.414z">
                        </path>
                    </svg>
                </button>
            </div>

            <!-- Konten Sidebar -->
            <div class="flex justify-between mx-10 mt-5 mb-2 w-fit border rounded-md">
                <button id="new-chat-btn"
                    class="flex flex-row items-center p-2 m-1 bg-gray-800 hover:bg-gray-700 rounded-md">
                    <img src="/image/new-section.svg"
                        class="bg-black hover:bg-slate-500 mr-2 h-6" alt="New Chat">
                    <p>Mulai Percakapan Baru</p>
                </button>
            </div>

            <!-- Judul Bagian -->
            <section class="mx-10 mb-2">
                <h1 class="text-2xl font-bold">Riwayat Percakapan</h1>
                <p class="flex items-center text-sm">
                    <img src="/image/history-toggle.svg" class="mr-3 h-4" alt="History Toggle">
                    Riwayat percakapan Anda dengan Satria BIPA
                </p>
            </section>

            <!-- Daftar Riwayat Chat -->
            <section id="chat-history-list"
                class="bg-[#1b1b21] p-5 mx-10 mb-5 rounded-md flex-grow overflow-y-auto scrollbar-custom">
                <div>
                    <p class="font-bold text-base mb-3">Terkini</p>
                    <ul id="chat-list" class="space-y-2 font-medium">
                        <!-- Chat items akan ditambahkan di sini -->
                    </ul>
                </div>
                <hr class="my-3">
                <div>
                    <p class="font-bold text-base mb-3">Kemarin</p>
                    <ul id="chat-list-2" class="space-y-2 font-medium">
                        <!-- Chat items akan ditambahkan di sini -->
                    </ul>
                </div>
            </section>

            <!-- Pengaturan dan Toggle Dark Mode -->
            <section class="mx-10 mb-5">
                <!-- Konten pengaturan tetap sama -->
                <div>
                    <a href="#"
                        class="flex items-center bg-[#1b1b21] hover:bg-white p-3 mt-3 rounded-md icon">
                        <!-- Icon Bantuan dan Teks -->
                        <!-- (Isi ikon dan teks sesuai kebutuhan) -->
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                            <!-- SVG ikon bantuan -->
                            <!-- ... -->
                        </svg>
                        <p class="ml-3">Bantuan</p>
                    </a>
                    <a href="#"
                        class="flex items-center bg-[#1b1b21] hover:bg-white p-3 mt-3 rounded-md icon">
                        <!-- Icon Pengaturan dan Teks -->
                        <!-- (Isi ikon dan teks sesuai kebutuhan) -->
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                            <!-- SVG ikon pengaturan -->
                            <!-- ... -->
                        </svg>
                        <p class="ml-3">Pengaturan</p>
                    </a>
                    <a href="#"
                        class="flex items-center bg-[#1b1b21] hover:bg-white p-3 mt-3 rounded-md icon">
                        <!-- Toggle Dark Mode -->
                        <div class="flex items-center">
                            <label class="flex items-center">
                                <input type="checkbox" value="" class="sr-only peer"
                                    onclick="toggleMode()">
                                <div
                                    class="relative mx-3 w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-['ðŸŒž'] dark:after:content-['ðŸŒœ'] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600">
                                </div>
                            </label>
                        </div>
                    </a>
                </div>
            </section>
        </aside>

        <!-- Area Konten Utama -->
        <div class="flex flex-col flex-1 md:ml-80 lg:ml-[22rem] xl:ml-[25rem]">
            <!-- Header -->
            <header class="sticky bg-white dark:bg-[#1B1B21] top-0 p-5 w-full z-10">
                <div class="flex justify-between items-center">
                    <button data-drawer-target="default-sidebar"
                        data-drawer-toggle="default-sidebar"
                        aria-controls="default-sidebar" type="button"
                        class="inline-flex items-center p-2 ms-3 text-sm text-gray-500 rounded-lg md:hidden hover:bg-gray-100 focus:outline-none dark:text-gray-400 dark:hover:bg-gray-700">
                        <span class="sr-only">Open sidebar</span>
                        <!-- Icon SVG -->
                        <svg class="w-6 h-6" aria-hidden="true" fill="currentColor"
                            viewBox="0 0 20 20"
                            xmlns="http://www.w3.org/2000/svg">
                            <path clip-rule="evenodd" fill-rule="evenodd"
                                d="M2 4.75A.75.75 0 012.75 4h14.5a.75.75 0 
                                    010 1.5H2.75A.75.75 0 012 4.75zm0 10.5a.75.75 0 
                                    01.75-.75h7.5a.75.75 0 010 1.5h-7.5a.75.75 0 
                                    01-.75-.75zM2 10a.75.75 0 01.75-.75h14.5a.75.75 0 
                                    010 1.5H2.75A.75.75 0 012 10z">
                            </path>
                        </svg>
                    </button>
                    <a href="/"
                        class="flex items-center border border-black/30 dark:border-white/30 bg-transparent p-1 px-4 rounded-full">
                        <img src="/image/logo.svg" alt="Logo BIPA"
                            class="h-8 mr-3">
                        <p class="dark:text-white text-black font-bold">
                            Satria
                            <span
                                class="ml-1 text-red-800 font-bold dark:text-transparent dark:bg-clip-text dark:bg-gradient-to-r from-yellow-200 to-yellow-500">BIPA</span>
                        </p>
                    </a>
                    <div class="flex items-center space-x-4">
                        <a href="/"
                            class="login text-base font-bold text-black hover:underline dark:text-white">Masuk</a>
                    </div>
                </div>
            </header>

            <!-- Area Chat Utama -->
            <main class="flex flex-col flex-1">
                <!-- Salam dan Rekomendasi Chat -->
                <div class="flex flex-col items-center p-5 greeting-section">
                    <div class="flex items-center">
                        <img src="../../public/image/waving-hand.png" class="mr-5 xl:h-16"
                            alt="Waving Hand">
                        <h1
                            class="text-3xl xl:mb-2 md:text-left text-center xl:text-6xl font-bold text-[#AE020B] dark:bg-clip-text dark:text-transparent pb-2 dark:bg-gradient-to-r from-yellow-500 via-yellow-200 to-yellow-500">
                            Halo, Ferry</h1>
                    </div>
                    <p class="font-bold">Mau belajar apa hari ini?</p>
                    <div
                        class="chat-recom flex flex-wrap my-14 justify-center space-x-2 ml-3 mr-4">
                        <a href="#"
                            class="flex items-center p-6 w-40 bg-gray-700 hover:bg-gray-500 rounded-md m-2">
                            <p class="text-sm text-white font-normal">Buatkan <span
                                    class="font-bold">pantun lucu</span> dalam bahasa Indonesia!</p>
                        </a>
                        <a href="#"
                            class="flex items-center p-6 w-40 bg-gray-700 hover:bg-gray-500 rounded-md m-2">
                            <p class="text-sm text-white font-normal">Cara <span
                                    class="font-bold">bertanya tentang arah</span></p>
                        </a>
                        <a href="#"
                            class="flex items-center p-6 w-40 bg-gray-700 hover:bg-gray-500 rounded-md m-2">
                            <p class="text-sm text-white font-normal"><span class="font-bold">Ayo, <span class="italic">ngobrol!</span></p>
                        </a>
                    </div>
                </div>

                <!-- Area Chat -->
                <div class="chat-area flex flex-col flex-1">
                    <div id="chat-box"
                        class="chat-box flex flex-col space-y-4 overflow-y-auto scrollbar-custom">
                        <!-- Pesan chat akan ditambahkan di sini -->
                    </div>
                </div>

                <!-- Input Chat -->
                <div class="input-area bg-white dark:bg-[#1B1B21]">
                    <div class="flex items-center relative w-full">
                        <input id="message-input"
                            placeholder="Tanya apa saja dalam bahasa Indonesia...." type="text"
                            class="flex-1 py-3 px-4 text-sm rounded-2xl border border-[#ffcc00] bg-[#1f1f1f] text-[#e0e0e0] pr-10" />
                        <button
                            class="absolute right-5 top-1/2 transform -translate-y-1/2">
                            <img src="/image/send.png" id="send-btn" alt="Send Icon"
                                class="h-6 w-6 hover:bg-slate-500" />
                        </button>
                    </div>
                    <p class="text-center text-sm md:text-base text-[#a1a1a1] mt-2">
                        <span class="ml-1 text-red-800 font-bold dark:text-transparent dark:bg-clip-text dark:bg-gradient-to-r from-yellow-200 to-yellow-500">Satria BIPA </span>mungkin dapat memberikan informasi yang keliru mengenai seseorang.
                </div>
            </main>

            <!-- Footer -->
            <footer
                class="w-full p-3 bg-[#828282] text-white dark:bg-[#2E3032] dark:text-gray-200">
                <div
                    class="container mx-auto flex flex-col md:flex-row justify-between items-center">
                    <div
                        class="flex items-center sm:ml-5 lg:ml-16 xl:mx-5 mb-4 md:mb-0">
                        <img src="/image/logo-bipa.png" alt="Logo BIPA"
                            class="h-7 mr-3 sm:h-8 md:h-10" />
                        <span
                            class="text-sm sm:text-base lg:text-lg">Hak Cipta Badan Pengembangan dan Pembinaan Bahasa Â© 2024</span>
                    </div>
                    <div class="flex z-20 space-x-3 items-center sm:mr-5 lg:mr-16">
                        <a href="https://www.instagram.com/bipakemdikbud" class="hover:text-gray-400">
                            <i class="fab fa-instagram">
                                <svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="24" height="24" viewBox="0 0 24 24"  class="w-7 h-5">
                                    <path fill="white" d="M 8 3 C 5.243 3 3 5.243 3 8 L 3 16 C 3 18.757 5.243 21 8 21 L 16 21 C 18.757 21 21 18.757 21 16 L 21 8 C 21 5.243 18.757 3 16 3 L 8 3 z M 8 5 L 16 5 C 17.654 5 19 6.346 19 8 L 19 16 C 19 17.654 17.654 19 16 19 L 8 19 C 6.346 19 5 17.654 5 16 L 5 8 C 5 6.346 6.346 5 8 5 z M 17 6 A 1 1 0 0 0 16 7 A 1 1 0 0 0 17 8 A 1 1 0 0 0 18 7 A 1 1 0 0 0 17 6 z M 12 7 C 9.243 7 7 9.243 7 12 C 7 14.757 9.243 17 12 17 C 14.757 17 17 14.757 17 12 C 17 9.243 14.757 7 12 7 z M 12 9 C 13.654 9 15 10.346 15 12 C 15 13.654 13.654 15 12 15 C 10.346 15 9 13.654 9 12 C 9 10.346 10.346 9 12 9 z"></path>
                                </svg>
                            </i>
                        </a>
                        <a href="https://www.youtube.com/@bipakemdikbud" class="hover:text-gray-400">
                            <i class="fab fa-youtube">
                                <svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="32" height="24" viewBox="0 0 24 24" class="w-7 h-5">
                                    <path fill="white" d="M 12 4 C 12 4 5.7455469 3.9999687 4.1855469 4.4179688 C 3.3245469 4.6479688 2.6479687 5.3255469 2.4179688 6.1855469 C 1.9999687 7.7455469 2 12 2 12 C 2 12 1.9999687 16.254453 2.4179688 17.814453 C 2.6479687 18.675453 3.3255469 19.352031 4.1855469 19.582031 C 5.7455469 20.000031 12 20 12 20 C 12 20 18.254453 20.000031 19.814453 19.582031 C 20.674453 19.352031 21.352031 18.674453 21.582031 17.814453 C 22.000031 16.254453 22 12 22 12 C 22 12 22.000031 7.7455469 21.582031 6.1855469 C 21.352031 5.3255469 20.674453 4.6479688 19.814453 4.4179688 C 18.254453 3.9999687 12 4 12 4 z M 12 6 C 14.882 6 18.490875 6.1336094 19.296875 6.3496094 C 19.465875 6.3946094 19.604391 6.533125 19.650391 6.703125 C 19.891391 7.601125 20 10.342 20 12 C 20 13.658 19.891391 16.397875 19.650391 17.296875 C 19.605391 17.465875 19.466875 17.604391 19.296875 17.650391 C 18.491875 17.866391 14.882 18 12 18 C 9.119 18 5.510125 17.866391 4.703125 17.650391 C 4.534125 17.605391 4.3956094 17.466875 4.3496094 17.296875 C 4.1086094 16.398875 4 13.658 4 12 C 4 10.342 4.1086094 7.6011719 4.3496094 6.7011719 C 4.3946094 6.5331719 4.533125 6.3946094 4.703125 6.3496094 C 5.508125 6.1336094 9.118 6 12 6 z M 10 8.5351562 L 10 15.464844 L 16 12 L 10 8.5351562 z"></path>
                                </svg>
                            </i>
                        </a>
                    </div>
                </div>
            </footer>
        </div>
    </div>

    <!-- JavaScript -->
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const newChatBtn = document.getElementById("new-chat-btn");
            const sendBtn = document.getElementById("send-btn");
            const messageInput = document.getElementById("message-input");
            const chatBox = document.getElementById("chat-box");
            const greetingSection = document.querySelector(".greeting-section");
            const chatList = document.getElementById("chat-list");

            // Array untuk menyimpan semua chat
            let chats = [
                {
                    id: 'chat-1',
                    name: 'Chat 1',
                    messages: [
                        { sender: 'user', text: 'Halo, bagaimana kabarmu?' },
                        { sender: 'bot', text: 'Halo! Saya baik-baik saja, terima kasih. Bagaimana dengan Anda?' },
                        { sender: 'user', text: 'Saya juga baik, terima kasih.' },
                        { sender: 'bot', text: 'Senang mendengarnya! Ada yang bisa saya bantu?' }
                    ]
                },
                {
                    id: 'chat-2',
                    name: 'Chat 2',
                    messages: []
                }
            ];
            let currentChatIndex = 0;
            let chatCounter = 3; // Chat berikutnya akan menjadi Chat 3

            // Menampilkan daftar chat pada sidebar
            function renderChatList() {
                chatList.innerHTML = ''; // Bersihkan daftar chat
                chats.forEach((chat, index) => {
                    const li = document.createElement('li');
                    li.innerHTML = `
                        <a href="#" class="chat-item block p-2 rounded-md cursor-pointer" data-chat-index="${index}">
                            ${chat.name}
                        </a>
                    `;
                    chatList.appendChild(li);

                    // Menambahkan event listener untuk chat item
                    li.querySelector('.chat-item').addEventListener('click', function (e) {
                        e.preventDefault();
                        const chatIndex = this.dataset.chatIndex;
                        switchToChat(parseInt(chatIndex));
                    });
                });
            }

            // Fungsi untuk switch ke chat tertentu
            function switchToChat(chatIndex) {
                currentChatIndex = chatIndex;
                const selectedChat = chats[currentChatIndex];
                if (!selectedChat) {
                    console.error(`Chat dengan index ${chatIndex} tidak ditemukan.`);
                    return;
                }

                // Menampilkan pesan dari chat yang dipilih
                chatBox.innerHTML = '';
                selectedChat.messages.forEach(message => {
                    const messageDiv = document.createElement('div');
                    messageDiv.classList.add(
                        message.sender === 'user' ? 'bg-[#ffcc00] text-black self-end text-right' :
                            'bg-[#2b2b2b] text-[#e0e0e0] self-start text-left',
                        'hover:shadow-md p-4 rounded-md max-w-xs w-fit shadow-lg transition-all duration-300'
                    );
                    messageDiv.textContent = message.text;
                    chatBox.appendChild(messageDiv);
                });

                // Menandai chat yang aktif di sidebar
                document.querySelectorAll('.chat-item').forEach((item, index) => {
                    if (index == currentChatIndex) {
                        item.classList.add('active-chat');
                    } else {
                        item.classList.remove('active-chat');
                    }
                });

                // Scroll ke bawah chat box
                chatBox.scrollTop = chatBox.scrollHeight;

                // Sembunyikan greeting jika sudah ada pesan
                if (selectedChat.messages.length > 0) {
                    greetingSection.classList.add('hidden');
                } else {
                    greetingSection.classList.remove('hidden');
                }
            }

            // Fungsi untuk membuat chat baru
            function createNewChat() {
                const chatId = `chat-${Date.now()}`;
                const chatName = `Chat ${chatCounter++}`;

                // Menambahkan chat baru ke array chats
                const newChat = {
                    id: chatId,
                    name: chatName,
                    messages: []
                };
                chats.push(newChat);

                // Render ulang daftar chat
                renderChatList();

                // Switch ke chat baru
                switchToChat(chats.length - 1);
            }

            // Fungsi untuk mengirim pesan
            async function sendMessage() {
                const messageText = messageInput.value.trim();
                if (messageText === '' || currentChatIndex === null) return;

                // Menambahkan pesan pengguna ke array chats
                const selectedChat = chats[currentChatIndex];
                if (!selectedChat) {
                    console.error(`Chat dengan index ${currentChatIndex} tidak ditemukan.`);
                    return;
                }

                const userMessage = {
                    sender: 'user',
                    text: messageText
                };
                selectedChat.messages.push(userMessage);

                // Menambahkan pesan pengguna ke chat box
                const messageDiv = document.createElement('div');
                messageDiv.classList.add('bg-[#ffcc00]', 'text-black', 'self-end', 'text-right',
                    'hover:shadow-md', 'p-4', 'rounded-md', 'max-w-xs', 'w-fit', 'shadow-lg',
                    'transition-all', 'duration-300');
                messageDiv.textContent = messageText;
                chatBox.appendChild(messageDiv);

                // Scroll ke bawah
                chatBox.scrollTop = chatBox.scrollHeight;

                // Clear input
                messageInput.value = '';

                // Sembunyikan greeting jika ini pesan pertama
                if (selectedChat.messages.length === 1) {
                    greetingSection.classList.add('hidden');
                }

                try {
                    // Ganti URL berikut dengan endpoint API Anda
                    console.log(messageText)
                    const response = await fetch('http://ec2-52-89-76-29.us-west-2.compute.amazonaws.com:6845/generate', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({ message: messageText })
                    });

                    if (!response.ok) {
                        console.error(`API error: ${response.status} ${response.statusText}`);
                        throw new Error(`API error: ${response.status}`);
                    }

                    const data = await response.json();
                    console.log(data)
                    const botResponse = data.response || 'Maaf, terjadi kesalahan dalam mendapatkan respons dari server.';

                    // Menambahkan pesan bot ke array chats
                    const botMessage = {
                        sender: 'bot',
                        text: botResponse
                    };
                    selectedChat.messages.push(botMessage);

                    // Menambahkan pesan bot ke chat box
                    const botMessageDiv = document.createElement('div');
                    botMessageDiv.classList.add('bg-[#2b2b2b]', 'text-[#e0e0e0]', 'self-start', 'text-left',
                        'hover:bg-[#333]', 'hover:shadow-md', 'p-4', 'rounded-md', 'max-w-xs', 'w-fit',
                        'shadow-lg', 'transition-all', 'duration-300');
                    botMessageDiv.textContent = botResponse;
                    chatBox.appendChild(botMessageDiv);

                    // Scroll ke bawah
                    chatBox.scrollTop = chatBox.scrollHeight;
                } catch (error) {
                    console.error('Error saat menghubungi API:', error);
                    // Menambahkan pesan error ke chat box
                    const errorDiv = document.createElement('div');
                    errorDiv.classList.add('bg-red-500', 'text-white', 'self-start', 'text-left',
                        'hover:shadow-md', 'p-4', 'rounded-md', 'max-w-xs', 'w-fit', 'shadow-lg',
                        'transition-all', 'duration-300');
                    errorDiv.textContent = 'Maaf, terjadi kesalahan saat menghubungi server.';
                    chatBox.appendChild(errorDiv);

                    // Scroll ke bawah
                    chatBox.scrollTop = chatBox.scrollHeight;
                }
            }

            // Menghubungkan event listeners
            newChatBtn.addEventListener('click', function () {
                createNewChat();
            });
            sendBtn.addEventListener('click', function () {
                sendMessage();
            });
            messageInput.addEventListener('keypress', function (e) {
                if (e.key === 'Enter') {
                    sendMessage();
                }
            });

            // Render daftar chat dan inisialisasi chat pertama
            renderChatList();
            switchToChat(currentChatIndex);
        });
    </script>

</body>

</html>
